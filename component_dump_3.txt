[g.jsxs("h2", { className: "text-xl font-bold text-slate-800 mb-2 px-2 flex items-center gap-2", children: [g.jsx(C0, { className: "text-blue-600", size: 24 }), "Última compra"] }), g.jsx("div", { className: "grid grid-cols-1 gap-2", children: s.length > 0 ? s.map((o, l) => g.jsxs("div", { onClick: () => n(o), className: `relative px-4 py-3 rounded-2xl border shadow-sm flex justify-between items-center active:scale-[0.98] transition-all cursor-pointer ${o.isRecent ? "bg-white border-slate-100 hover:border-green-200" : "bg-white border-slate-100 hover:border-red-200"}`, children: [g.jsxs("div", { className: "flex-1 min-w-0 pr-2", children: [g.jsx("h3", { className: "font-black text-slate-800 text-sm truncate uppercase leading-tight", children: o.name }), g.jsxs("div", { className: "flex items-center gap-2 mt-0.5", children: [g.jsxs("span", { className: `text-[11px] font-bold ${o.isRecent ? "text-green-600" : "text-red-500"}`, children: ["Hace ", o.daysDiff, " días"] }), g.jsxs("span", { className: "text-[10px] text-slate-400 font-medium truncate", children: ["• ", o.city] })] })] }), g.jsx("div", { className: `flex-shrink-0 w-2.5 h-2.5 rounded-full ${o.isRecent ? "bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.4)]" : "bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.4)]"}` })] }, l)) : g.jsxs("div", { className: "text-center py-12 text-slate-400", children: [g.jsx(C0, { size: 48, className: "mx-auto mb-3 opacity-20" }), g.jsx("p", { children: "No hay pedidos registrados" })] }) }), r && g.jsx(rD, { client: r, onClose: () => n(null) })] }) } function iD() {
  const { orders: e, clients: t, setOrders: r, setClients: n, years: i, addNewYear: s, scriptUrl: o, setScriptUrl: l, syncToGoogle: f, objectives: h, yearlySales: d, realBilling: p, setObjectives: x, setYearlySales: _, setRealBilling: A, uploadBackupToDrive: v, listBackupsFromDrive: S, restoreBackupFromDrive: w, deleteBackupFromDrive: T } = an(), y = Re.useRef(null), [C, D] = Re.useState("idle"), [b, O] = Re.useState(""), [V, z] = Re.useState(0), [H, K] = Re.useState(!1), [G, X] = Re.useState([]), [ce, oe] = Re.useState(!1), [ae, ve] = Re.useState(!1), [ne, Y] = Re.useState(null), le = async () => { if (!window.confirm("¿Crear copia de seguridad en Google Drive?")) return; ve(!0); const F = await v(); ve(!1), F.success ? alert("✅ Copia de seguridad guardada en Drive.") : alert("❌ Error: " + F.error) }, _e = async () => { ve(!0); const F = await S(); ve(!1), F.result === "success" ? (X(F.files), oe(!0)) : alert("❌ Error al obtener copias: " + (F.error || "Desconocido")) }, P = async F => { if (!window.confirm("⚠️ ATENCIÓN: Esto SOBRESCRIBIRÁ todos tus datos locales con los de la copia. ¿Continuar?")) return; Y(F); const Q = await w(F); Y(null), Q.success ? (alert("✅ Datos restaurados correctamente."), oe(!1)) : alert("❌ Error al restaurar: " + (Q.error || "Desconocido")) }, J = () => { const F = ar.book_new(), Q = ar.json_to_sheet(e); ar.book_append_sheet(F, Q, "Pedidos"); const he = ar.json_to_sheet(t); ar.book_append_sheet(F, he, "Clientes_App"); const pe = Object.entries(h).map(([Ue, Pe]) => ({ Mes: Ue, Obj3: Pe.obj3, Obj4: Pe.obj4, Obj5: Pe.obj5 })), ge = ar.json_to_sheet(pe); ar.book_append_sheet(F, ge, "Objetivos"); const de = Object.entries(d).map(([Ue, Pe]) => ({ Mes: Ue, ...Pe })), De = ar.json_to_sheet(de); ar.book_append_sheet(F, De, "Ventas_Anuales"); const U = Object.entries(p).map(([Ue, Pe]) => ({ Mes: Ue, ...Pe })), Ge = ar.json_to_sheet(U); ar.book_append_sheet(F, Ge, "Facturacion_Real"); const Ve = new Date().toISOString().split("T")[0]; G5(F, `Copia_Seguridad_Ventas_${Ve}.xlsx`) }, W = F => { const Q = F.target.files[0]; if (!Q || !window.confirm("⚠️ ATENCIÓN: Esto sobrescribirá todos los datos actuales por los del archivo. ¿Deseas continuar?")) return; const he = new FileReader; he.onload = pe => { const ge = pe.target.result, de = X0(ge, { type: "binary" }); if (de.SheetNames.includes("Pedidos")) { const De = de.Sheets.Pedidos, U = ar.sheet_to_json(De); r(U) } if (de.SheetNames.includes("Clientes_App")) { const De = de.Sheets.Clientes_App, U = ar.sheet_to_json(De); n(U) } if (de.SheetNames.includes("Objetivos")) { const De = de.Sheets.Objetivos, U = ar.sheet_to_json(De), Ge = {}; U.forEach(Ue => { Ge[Ue.Mes] = { obj3: Ue.Obj3 || "", obj4: Ue.Obj4 || "", obj5: Ue.Obj5 || "" } }), ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"].forEach(Ue => { Ge[Ue] || (Ge[Ue] = { obj3: "", obj4: "", obj5: "" }) }), x(Ge) } if (de.SheetNames.includes("Ventas_Anuales")) { const De = de.Sheets.Ventas_Anuales, U = ar.sheet_to_json(De), Ge = {}; U.forEach(Ve => { const { Mes: Ue, ...Pe } = Ve; Ge[Ue] = Pe }), _(Ge) } if (de.SheetNames.includes("Facturacion_Real")) { const De = de.Sheets.Facturacion_Real, U = ar.sheet_to_json(De), Ge = {}; U.forEach(Ve => { const { Mes: Ue, ...Pe } = Ve; Ge[Ue] = Pe }), A(Ge) } alert("✅ Restauración completada con éxito.") }, he.readAsBinaryString(Q) }; re